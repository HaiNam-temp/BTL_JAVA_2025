<app-header></app-header>

<div class="container my-4">
  <div class="intro-section text-center mb-4">
    <h1>ğŸ”” Trang ThÃ´ng BÃ¡o</h1>
    <ng-container *ngIf="isLoggedIn; else loggedOutMessage">
      <p *ngIf="!isLoading">Báº¡n cÃ³ <strong>{{ unreadCount }}</strong> thÃ´ng bÃ¡o má»›i</p>
      <button *ngIf="notifications.length > 0 && unreadCount > 0 && !isLoading"
              (click)="markAllAsRead()"
              class="btn btn-sm btn-outline-light mt-2">
        ÄÃ¡nh dáº¥u táº¥t cáº£ lÃ  Ä‘Ã£ Ä‘á»c
      </button>
    </ng-container>
    <ng-template #loggedOutMessage>
      <p>Vui lÃ²ng <a routerLink="/login" class="text-warning">Ä‘Äƒng nháº­p</a> Ä‘á»ƒ xem thÃ´ng bÃ¡o.</p>
    </ng-template>
  </div>

  <div *ngIf="isLoading && isLoggedIn" class="text-center my-5">
    <div class="spinner-border text-light" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Äang táº£i thÃ´ng bÃ¡o...</p>
  </div>

  <div *ngIf="!isLoading && isLoggedIn && notifications.length === 0" class="alert alert-info text-center" role="alert">
    Báº¡n khÃ´ng cÃ³ thÃ´ng bÃ¡o nÃ o.
  </div>

  <ul *ngIf="!isLoading && isLoggedIn && notifications.length > 0" class="notification-list list-unstyled">
    <li *ngFor="let noti of notifications"
        class="notification-item"
        [class.unread]="!noti.isRead"
        [class.read]="noti.isRead"
        (click)="markAsRead(noti)"
        tabindex="0"
        (keydown.enter)="markAsRead(noti)">

      <span class="icon-container me-3 fs-4">
        <i [ngClass]="getIconClass(noti.icon)" *ngIf="getIconClass(noti.icon)"></i>
        <span *ngIf="!getIconClass(noti.icon)">{{ noti.icon }}</span>
      </span>

      <div class="content flex-grow-1">
        <p class="mb-1 message-content">{{ noti.message }}</p>
        <small class="time-ago">{{ noti.displayTime }}</small>
      </div>
      <span *ngIf="!noti.isRead" class="unread-indicator ms-auto" title="ChÆ°a Ä‘á»c"></span>
    </li>
  </ul>
</div>

<app-footer></app-footer>